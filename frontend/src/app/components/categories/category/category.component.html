<form *ngIf="form" [formGroup]="form" class="d-flex flex-column w-100 p-4 content--standard">
    <div class="d-flex align-items-center w-100 mb-3">
        <h1 *ngIf="!guid" class="heading--desktop04">
            Create Category
        </h1>
        <h1 *ngIf="guid" class="heading--desktop04">
            Update Category
        </h1>
        <div class="ms-auto">
            <button class="btn btn--null" (click)="list()">
                <i class="fa fa-list me-2"></i>
                List
            </button>
            <button *ngIf="guid" class="btn btn--null ms-2">
                <i class="fa fa-copy me-2"></i>
                Copy
            </button>
            <button *ngIf="guid" class="btn btn--null ms-2">
                <i class="fa fa-share-alt me-2"></i>
                Share
            </button>
        </div>
    </div>
    <div class="d-flex w-100">
        <div class="d-flex flex-column w-100 pe-2 py-3">
            <span class="p-float-label w-100">
                <input autocomplete="off" required formControlName="name" [readonly]="!editable" [(ngModel)]="body.name" id="name" class="input--standard w-100" type="text" pInputText> 
                <label for="name">Name<small class="required">*</small></label>
            </span>
            <span class="text-danger text--desktop04 semibold mt-1 ms-1" *ngIf="hasError('name')">
                {{hasError('name')}}
            </span>
        </div>
        <div class="d-flex flex-column w-100 ps-2 py-3">
            <span class="p-float-label w-100">
                <input autocomplete="off" [ngModelOptions]="{standalone: true}" [readonly]="!editable" [(ngModel)]="body.description" id="description" class="input--standard w-100" type="text" pInputText> 
                <label for="description">Description</label>
            </span>
        </div>
    </div>
    <div class="d-flex flex-column w-100 mt-2" *ngIf="subcategoriesLoaded">
        <p-table [paginator]="true" [rows]="10" class="w-100" #dt [value]="subcategories">
            <ng-template pTemplate="caption">
                <div class="d-flex align-items-center table-header ps-md-3 w-100">
                    <h3 class="text--desktop01 my-2">
                        Subcategories
                    </h3>
                    <div class="ms-md-auto"></div>
                    <button *ngIf="editable && hasSubcategoriesBulkAction" class="btn btn--danger text--desktop03 px-3" (click)="removeSubcategories()">
                        <i class="fa fa-times me-2"></i>
                        Remove selected
                    </button>
                    <button *ngIf="editable" class="btn btn--secondary ms-2 text--desktop03 px-3" (click)="addSubcategory()">
                        <i class="fa fa-plus me-2"></i>
                        Add Subcategory
                    </button>
                </div>
            </ng-template>
            <ng-template pTemplate="header">
                <tr>
                    <th class="th--options" *ngIf="editable"></th>
                    <th class="text-center">Name</th>
                    <th class="text-center">Description</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-item let-editing="editing" let-ri="rowIndex">
                <tr>
                    <td style="width: 10%" *ngIf="editable">
                        <p-checkbox [binary]="true" [ngModelOptions]="{standalone: true}" value="1" [(ngModel)]="item.$_select"></p-checkbox>
                    </td>
                    <td style="width: 45%" pEditableColumn>
                        <p-cellEditor>
                            <ng-template pTemplate="input">
                                <span *ngIf="!editable">
                                    {{item.name || 'Name...'}}
                                </span>
                                <input autocomplete="off" [ngModelOptions]="{standalone: true}" *ngIf="editable" pInputText class="input--standard w-100" type="text" [(ngModel)]="item.name">
                            </ng-template>
                            <ng-template pTemplate="output">
                                {{item.name || 'Name...'}}
                            </ng-template>
                        </p-cellEditor>
                    </td>
                    <td style="width: 45%" pEditableColumn>
                        <p-cellEditor>
                            <ng-template pTemplate="input">
                                <span *ngIf="!editable">
                                    {{item.description || 'Description...'}}
                                </span>
                                <input autocomplete="off" [ngModelOptions]="{standalone: true}" *ngIf="editable" pInputText class="input--standard w-100" type="text" [(ngModel)]="item.description">
                            </ng-template>
                            <ng-template pTemplate="output">
                                {{item.description || 'Description...'}}
                            </ng-template>
                        </p-cellEditor>
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </div>
    <div class="d-flex w-100 mt-4 content--footer" *ngIf="!guid">
        <div class="ms-md-auto">
            <button (click)="submit()" class="btn btn--standard">
                <i class="fa fa-save me-2"></i>
                Save
            </button>
        </div>
    </div>
    <div class="d-flex w-100 mt-4 content--footer" *ngIf="guid && !editable">
        <div class="ms-md-auto">
            <button (click)="editable = true" class="btn btn--secondary">
                <i class="fa fa-edit me-2"></i>
                Edit
            </button>
        </div>
    </div>
    <div class="d-flex w-100 mt-4 content--footer" *ngIf="guid && editable">
        <div class="ms-md-auto">
            <button (click)="restore()" class="btn btn--null me-2">Cancel</button>
        </div>
        <div class="ms-md-2">
            <button (click)="submit()" class="btn btn--standard">
                <i class="fa fa-save me-2"></i>
                Save
            </button>
        </div>
    </div>
</form>